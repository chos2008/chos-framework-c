DEBUG=../Debug

PATH_VS=D:\usr\bin\Microsoft Visual Studio\VC98
CL="$(PATH_VS)\Bin\cl.exe"
LINK="$(PATH_VS)\Bin\link.exe"

INCLUDE="D:\usr\bin\Microsoft Visual Studio\VC98\Include"
LIB="D:\usr\bin\Microsoft Visual Studio\VC98\Lib"


INCLUDE_LIB_LOG=D:\home\admin\workstation\c\liblog
LIB_LIB_LOG=D:\home\admin\workstation\c\liblog\Debug

INCLUDE_MYSQL=D:\usr\srv\mysql51\include
LIB_MYSQL=D:\usr\srv\mysql51\lib\debug


INCLUDE_LUA=D:\usr\bin\Lua\5.1\include
LIB_LUA=D:\usr\bin\Lua\5.1\lib


liblog.lib: clean
	$(CL) /GX /W3 /I $(INCLUDE) /I$(INCLUDE_LUA) /I$(INCLUDE_LIB_LOG) /c /Fo$(DEBUG)/ ../gs/LuaContext.cpp
	$(CL) /GX /W3 /I $(INCLUDE) /I$(INCLUDE_LUA) /I$(INCLUDE_LIB_LOG) /c /Fo$(DEBUG)/ ../gs/LuaScriptExecutor.cpp
	$(CL) /GX /W3 /I $(INCLUDE) /I$(INCLUDE_LUA) /I$(INCLUDE_LIB_LOG) /c /Fo$(DEBUG)/ LuaContextTest.cpp


#	lib /nologo log.obj /out:./liblog.lib 
	$(LINK) /LIBPATH:$(LIB) /LIBPATH:$(LIB_LIB_LOG) /LIBPATH:$(LIB_MYSQL) /LIBPATH:$(LIB_LUA) /OUT:$(DEBUG)/LuaContextTest.exe $(DEBUG)/*.obj
#	$(LINK) /DLL /LIBPATH:$(LIB) /OUT:$(DEBUG)/liblog.dll *.obj
#	$(LINK) /DLL /LIBPATH:$(LIB) /OUT:$(DEBUG)/liblog.dll $(DEBUG)/*.obj
# $(LINK) *.obj /LIBPATH:"D:\usr\bin\Microsoft Visual Studio\VC98\Lib"
	cp ../liblog.dll $(DEBUG)/
	cp ./test.lua $(DEBUG)/

clean:
	rm -Rf ./*.bak
	rm -Rf ./*.o
	rm -Rf ./*.obj
	rm -Rf ./*.exe
	rm -Rf ../Debug/*